{"version":3,"sources":["constants.tsx","requestCache.tsx","translations.tsx","utils.tsx","gmail/gmailAPI.ts","components/Swipeable.tsx","gmail/MessageHeader.tsx","gmail/MessageBody.tsx","gmail/Message.tsx","gmail/Thread.tsx","gmail/ThreadList.tsx","gmail/LabelGroup.tsx","gmail/InboxView.tsx","GMail.tsx","components/TransferList.tsx","Settings.tsx","components/MiniDrawer.tsx","App.tsx","serviceWorker.js","index.tsx","logo.svg"],"names":["systemFolders","categories","noShow","concat","defaultSettings","labels","bundleLabels","sortLabel","keys","CacheFirst","cacheName","cacheInit","cache","this","initCache","caches","open","request","requestKey","response","put","Request","Response","JSON","stringify","Error","match","cachedResponse","json","undefined","fromCache","fromNetwork","NetworkFirst","translations","CATEGORY_UPDATES","CATEGORY_PERSONAL","CATEGORY_SOCIAL","CATEGORY_FORUMS","CATEGORY_PROMOTIONS","INBOX","DRAFT","CHAT","IMPORTANT","translate","labelName","arrayToMap","array","keyExtractor","valueExtractor","result","reduce","prev","curr","discoveryDocs","clientId","credentials","web","client_id","apiKey","api_key","gmailInstance","labelCache","labelCacheCF","threadCache","gmailApi","gapi","isSignedIn","signInStatusHandlers","window","load","client","init","scope","then","gmail","users","auth2","getAuthInstance","listen","updateSignInStatus","bind","get","error","console","log","authorize","handler","push","forEach","currentUser","getBasicProfile","labelIds","cacheKey","cacheFirst","length","batch","newBatch","labelId","add","id","userId","responses","Object","values","map","labelsSorted","filter","label","threadsTotal","sort","l1","l2","name","localeCompare","list","includes","getLabels","threads","labelFilter","q","resultSizeEstimate","a","b","historyId","messageId","messages","modify","removeLabelIds","threadId","threadIds","signIn","signOut","styles","createStyles","root","position","revealContent","top","bottom","zIndex","width","overflow","left","right","swipeCanceled","transform","transition","swipeRight","swipeLeft","grow","shrink","Swipable","props","touchStartX","latestDeltaX","leftRef","rightRef","swipeRef","isSwipeLeft","isSwipeRight","state","cancelSwipe","swipedLeft","swipingLeft","swipedRight","swipingRight","React","createRef","event","stopPropagation","touches","clientX","currentTarget","deltaX","setState","current","style","threshold","clientWidth","action","setTimeout","classes","className","clsx","ref","content","onTouchStart","touchStart","onTouchMove","touchMove","onTouchEnd","touchEnd","children","Component","withStyles","headerMap","headers","header","value","display","overflowX","archive","cursor","archiveSwipe","backgroundColor","height","MessageHeader","mounted","e","archiveMessage","message","noOfMessages","isThread","payload","subject","from","replace","split","read","Swipeable","CSSTransition","in","unmountOnExit","timeout","classNames","nodeRef","Avatar","title","snippet","Tag","text","key","textColor","color","onClick","makeStyles","tagStyle","background","borderRadius","alignSelf","marginRight","padding","iconStyle","important","attachmentCache","getBody","encodedBody","convert","parts","body","data","getHTMLPart","arr","x","mimeType","decodeURIComponent","escape","atob","getAttachment","attachment","cid","Attachment","filename","MessageBody","iframe","timeOut","attachments","getAttachments","all","byCID","part","attachId","attachmentId","recAttachments","assign","join","logo","loadedAttachment","contentDocument","getElementsByTagName","innerHTML","contentWindow","document","scrollHeight","cancelTimeout","setIframeRef","Message","toggleOpen","Collapse","mountOnEnter","GmailThread","thread","getThread","_","archiveThread","lastMessage","trigger","ThreadList","LabelGroup","labelColors","category","unread","query","listThreads","Math","min","messagesUnread","archiveThreads","onArchived","rootRef","onExited","ListItem","button","ListItemText","primary","secondary","archiveClicked","paddingLeft","InboxView","settings","lsget","getThreads","getLabelFilter","c","l","List","categoryArchived","labelArchived","theme","flex","overflowY","palette","paper","withTheme","GMail","profileImage","onActivation","onSignInStatusChanged","src","alt","Button","variant","useStyles","margin","cardHeader","spacing","minHeight","not","indexOf","intersection","TransferList","useState","checked","setChecked","setLeft","setRight","getLabel","labelProvider","rightUpdated","selectionChanged","useEffect","leftChecked","rightChecked","handleToggle","currentIndex","newChecked","splice","numberOfChecked","items","handleToggleAll","customList","Card","CardHeader","avatar","Checkbox","indeterminate","disabled","inputProps","subheader","Divider","dense","component","role","ListItemIcon","tabIndex","disableRipple","Grid","container","justify","alignItems","item","direction","size","added","aria-label","removed","Settings","listAllLabels","toLowerCase","labelMap","unchosen","lsset","remove","hide","drawer","flexShrink","whiteSpace","drawerOpen","transitions","create","easing","sharp","duration","enteringScreen","drawerClose","leavingScreen","breakpoints","up","toolbar","justifyContent","mixins","flexGrow","MiniDrawer","useTheme","setOpen","handleDrawerClose","otherProps","CssBaseline","Drawer","IconButton","appBar","marginTop","marginLeft","shroud","down","appBarShift","menuButton","buttons","App","prefersDarkMode","useMediaQuery","setSignedIn","setProfileImage","setTitle","profile","getCurrentUserProfile","getImageUrl","useMemo","createMuiTheme","type","ThemeProvider","AppBar","Toolbar","edge","Typography","noWrap","to","path","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","ReactDOM","render","StrictMode","getElementById","URL","process","href","origin","addEventListener","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker","module","exports"],"mappings":"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","file":"static/js/main.0da6d410.chunk.js","sourcesContent":["import { ILabel } from \"./gmail/gmailAPI\";\r\n\r\nexport const stateLabels = ['STARRED', 'UNREAD', 'IMPORTANT']\r\nexport const systemFolders = ['SENT', 'TRASH', 'SPAM', 'DRAFT']\r\nexport const categories = ['category:social', 'category:promotions', 'category:updates', 'category:forums', 'category:reservations', 'category:purchases'] //'category:primary', \r\nexport const noShow = stateLabels.concat(systemFolders);\r\nexport const INBOX = 'INBOX';\r\nexport const defaultSettings : ISettings = { labels: {}, bundleLabels: {}, sortLabel: {} }\r\nexport const keys = { settings: 'settings', CACHE_ALL_LABELS: 'ALL-LABELS', CACHE_LABELS: 'LABELS', CACHE_THREADS: \"THREADS\", CACHE_BUNDLES: 'BUNDLES', CACHE_ATTACHMENTS: 'ATTACHMENTS' }\r\nexport interface ISettings {\r\n    labels: {},\r\n    bundleLabels:  { [key: string]: ILabel },\r\n    sortLabel: {}\r\n}","\r\nexport default class CacheFirst {\r\n    cacheInit: Promise<any>;\r\n    cache: Cache | null = null;\r\n    /**\r\n     * \r\n     * @param {string} cacheName \r\n     */\r\n    constructor(cacheName: string) {\r\n        this.cacheInit = this.initCache(cacheName);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {string} cacheName \r\n     */\r\n    async initCache(cacheName: string) {\r\n        this.cache = await caches.open(cacheName);\r\n        return this.cache;\r\n    }\r\n\r\n    async fromNetwork(request: Promise<any> | undefined, requestKey: RequestInfo) {\r\n        if (request) {\r\n            let response = await request;\r\n            this.cache?.put(new Request(requestKey), new Response(JSON.stringify(response)))\r\n            return response;\r\n        }\r\n        throw new Error(\"no request given\")\r\n    }\r\n\r\n    async fromCache(requestKey: RequestInfo) {\r\n        let cachedResponse = await this.cache?.match(new Request(requestKey));\r\n        if (cachedResponse) {\r\n            return await cachedResponse.json();\r\n        }\r\n        throw new Error(\"not found in cache\");\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {string} requestKey \r\n     * @param {Promise} request\r\n     */\r\n    async get(requestKey: RequestInfo, request: Promise<any> | undefined = undefined) {\r\n        if (!this.cache) {\r\n            await this.cacheInit;\r\n        }\r\n        try {\r\n            return await this.fromCache(requestKey)\r\n        } catch (err) {\r\n            try {\r\n                return await this.fromNetwork(request, requestKey);\r\n            } catch (err) {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport class NetworkFirst extends CacheFirst {\r\n\r\n    /**\r\n     * \r\n     * @param {string} requestKey \r\n     * @param {Promise} request \r\n     */\r\n    async get(requestKey: RequestInfo, request: Promise<any> | undefined = undefined) {\r\n        if (!this.cache) {\r\n            await this.cacheInit;\r\n        }\r\n        try {\r\n            return await this.fromNetwork(request, requestKey);\r\n        } catch (err) {\r\n            try {\r\n                return await this.fromCache(requestKey)\r\n            }\r\n            catch (err) {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n}","const translations : any = {\r\n    CATEGORY_UPDATES: \"Benachrichtigungen\",\r\n    'category:updates': \"Benachrichtigungen\",\r\n    CATEGORY_PERSONAL: \"Persönlich\",\r\n    'category:personal': \"Persönlich\",\r\n    CATEGORY_SOCIAL: \"Soziale Medien\",\r\n    'category:social': \"Soziale Medien\",\r\n    CATEGORY_FORUMS: \"Foren\",\r\n    'category:forums': \"Foren\",\r\n    CATEGORY_PROMOTIONS: \"Werbung\",\r\n    'category:promotions': \"Werbung\",\r\n    'category:reservations': \"Reisen\",\r\n    'category:purchases': \"Käufe\",\r\n    INBOX: \"Posteingang\",\r\n    DRAFT: \"Entwürfe\",\r\n    CHAT: \"Chats\",\r\n    IMPORTANT: \"Wichtig\"\r\n}\r\n\r\nexport default function translate(labelName: string) {\r\n    if (translations[labelName])\r\n        return translations[labelName]\r\n    return labelName\r\n}","export function arrayToMap<T, V>(array: T[], keyExtractor: (el: T) => string, valueExtractor: (el: T) => V) {\r\n    let result: { [key: string]: V } = {};\r\n    array.reduce((prev, curr)=>{\r\n        prev[keyExtractor(curr)] = valueExtractor(curr);\r\n        return prev\r\n    }, result);\r\n    return result;\r\n}","import { keys, noShow } from \"../constants\";\r\nimport CacheFirst, { NetworkFirst } from \"../requestCache\";\r\nimport credentials from '../credentials.json';\r\n\r\n\r\n// Authorization scopes required by the API; \r\nconst scope = 'https://www.googleapis.com/auth/gmail.modify';\r\n// Array of API discovery doc URLs for APIs used by the quickstart\r\nconst discoveryDocs = [\"https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest\"];\r\n// api keys \r\nconst clientId = credentials.web.client_id;\r\nconst apiKey = credentials.web.api_key;\r\n\r\n\r\nexport class GmailApi {\r\n    labelCache: NetworkFirst = new NetworkFirst(keys.CACHE_LABELS);\r\n    labelCacheCF: CacheFirst = new CacheFirst(keys.CACHE_LABELS);\r\n    threadCache: NetworkFirst = new NetworkFirst(keys.CACHE_THREADS);\r\n    gmailApi: { labels: any, threads: any, messages: any } | null = null;\r\n    gapi: any;\r\n    isSignedIn: boolean = false;\r\n    signInStatusHandlers: SigninStatusHandler[] = [];\r\n\r\n    init() {\r\n        this.gapi = window.gapi;\r\n        this.gapi.load('client:auth2', () => {\r\n            this.gapi.client.init({ apiKey, clientId, discoveryDocs, scope }).then(() => {\r\n                this.gmailApi = window.gapi.client.gmail.users;\r\n                //register signin status event handler\r\n                this.gapi.auth2.getAuthInstance().isSignedIn.listen(this.updateSignInStatus.bind(this));\r\n\r\n                // Handle the initial sign-in state.\r\n                this.updateSignInStatus(this.gapi.auth2.getAuthInstance().isSignedIn.get());\r\n            }, (error: any) => {\r\n                console.log('Error: ' + error)\r\n            })\r\n        });\r\n        this.authorize.bind(this)\r\n    }\r\n\r\n    onSignInStatusChanged(handler: SigninStatusHandler) {\r\n        this.signInStatusHandlers.push(handler);\r\n        handler(this.isSignedIn);\r\n    }\r\n\r\n    updateSignInStatus(isSignedIn: boolean) {\r\n        this.isSignedIn = isSignedIn;\r\n        this.signInStatusHandlers.forEach(handler => handler(isSignedIn));\r\n    }\r\n\r\n    getCurrentUserProfile(): Profile {\r\n        return this.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();\r\n    }\r\n\r\n    async getLabels(labelIds: string[], cacheKey: string, cacheFirst?: boolean) {\r\n        if (labelIds.length > 0) {\r\n            let batch = window.gapi.client.newBatch();\r\n            labelIds.forEach(labelId => {\r\n                batch.add(this.gmailApi?.labels.get({\r\n                    id: labelId,\r\n                    userId: 'me'\r\n                }));\r\n            });\r\n            let cache = cacheFirst ? this.labelCacheCF : this.labelCache;\r\n            let responses: Response<Response<ILabel>> = await cache.get(cacheKey, batch);\r\n            let labels: ILabel[] = Object.values(responses.result).map((response: Response<ILabel>) => response.result);\r\n            let labelsSorted = labels.filter(label => label.threadsTotal > 0).sort((l1, l2) => l1.name.localeCompare(l2.name));\r\n            return labelsSorted\r\n        }\r\n        return [];\r\n    }\r\n\r\n\r\n    async listAllLabels(): Promise<ILabel[]> {\r\n        return this.gmailApi?.labels.list({\r\n            'userId': 'me'\r\n        }).then((response: { result: { labels: [{ id: string }]; }; }) => {\r\n            let labelIds = response.result.labels.filter(label => !noShow.includes(label.id)).map(label => label.id);\r\n            return this.getLabels(labelIds, keys.CACHE_ALL_LABELS);\r\n        });\r\n    }\r\n\r\n    async getThread(id: string): Promise<Response<IThread>> {\r\n        return this.threadCache.get(id, this.gmailApi?.threads.get({ userId: 'me', id }))\r\n    }\r\n\r\n    async listThreads(cacheKey: string, labelFilter?: string, labelIds: string[] = ['INBOX']): Promise<ThreadResult> {\r\n        return this.threadCache.get(cacheKey, this.gmailApi?.threads.list({\r\n            userId: 'me',\r\n            q: labelFilter,\r\n            labelIds\r\n        })).then((response: Response<ThreadResult>) => {\r\n            if (response.result.resultSizeEstimate > 0) {\r\n                response.result.threads = response.result.threads.sort((a, b) => {\r\n                    return b.historyId - a.historyId\r\n                });\r\n            }\r\n            return response.result;\r\n        });\r\n    }\r\n\r\n    async archiveMessage(messageId: string): Promise<IMessage> {\r\n        return this.gmailApi?.messages.modify({\r\n            userId: 'me',\r\n            id: messageId,\r\n            removeLabelIds: [\"INBOX\"]\r\n        }).then((response: Response<IMessage>) => {\r\n            return response.result;\r\n        });\r\n    }\r\n\r\n    async archiveThread(threadId: string): Promise<IThread> {\r\n        return this.gmailApi?.threads.modify({\r\n            userId: 'me',\r\n            id: threadId,\r\n            removeLabelIds: [\"INBOX\"]\r\n        }).then((response: Response<IThread>) => {\r\n            return response.result;\r\n        });\r\n    }\r\n\r\n    async archiveThreads(threadIds: string[]){\r\n        let batch = window.gapi.client.newBatch();\r\n        threadIds.forEach(threadId => {\r\n            batch.add(this.gmailApi?.threads.modify({\r\n                userId: 'me',\r\n                id: threadId,\r\n                removeLabelIds: [\"INBOX\"]\r\n            }));\r\n        });\r\n        let responses: Response<Response<IThread>> = await batch;\r\n        return responses;\r\n    }\r\n\r\n\r\n    authorize() {\r\n        this.gapi.auth2.getAuthInstance().signIn();\r\n    }\r\n\r\n    signOut() {\r\n        this.gapi.auth2.getAuthInstance().signOut();\r\n    }\r\n}\r\n\r\n\r\ninterface SigninStatusHandler {\r\n    (isSignedIn: boolean): void;\r\n}\r\n\r\ninterface Profile {\r\n    getId(): string;\r\n    getName(): string;\r\n    getGivenName(): string;\r\n    getFamilyName(): string;\r\n    getImageUrl(): string;\r\n    getEmail(): string;\r\n}\r\n\r\nexport interface ILabel {\r\n    id: string,\r\n    threadsTotal: number,\r\n    name: string,\r\n    color?: {\r\n        textColor: string,\r\n        backgroundColor: string\r\n    }\r\n    messageListVisibility: string,\r\n    labelListVisibility: string,\r\n    type: string,\r\n    messagesTotal: number,\r\n    messagesUnread: number,\r\n    threadsUnread: number,\r\n};\r\n\r\nexport interface IThread {\r\n    id: string,\r\n    snippet: string,\r\n    historyId: number,\r\n    messages?: IMessage[]\r\n}\r\n\r\nexport interface ThreadResult {\r\n    threads: IThread[],\r\n    nextPageToken?: string,\r\n    resultSizeEstimate: number\r\n}\r\n\r\nexport interface Response<T> {\r\n    result: T\r\n}\r\n\r\nexport interface IMessage {\r\n    id: string,\r\n    threadId: string,\r\n    labelIds: [\r\n        string\r\n    ],\r\n    snippet: string,\r\n    historyId: number,\r\n    internalDate: number,\r\n    payload: {\r\n        partId: string,\r\n        mimeType: string,\r\n        filename: string,\r\n        headers: [\r\n            {\r\n                name: string,\r\n                value: string\r\n            }\r\n        ],\r\n        body: IAttachment,\r\n        parts: any[]\r\n    },\r\n    sizeEstimate: number,\r\n    raw: Buffer\r\n}\r\n\r\nexport interface IAttachment {\r\n    attachmentId: String,\r\n    size: number,\r\n    data: Buffer\r\n}\r\n\r\nconst gmailInstance = new GmailApi();\r\nexport default gmailInstance;\r\n\r\n","import React, { TouchEvent } from 'react';\r\nimport { createStyles, withStyles, WithStyles } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\n\r\nconst styles = createStyles({\r\n    root: {\r\n        position: \"relative\",\r\n    },\r\n    revealContent: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        bottom: 0,\r\n        zIndex: 0,\r\n        width: 0,\r\n        overflow: \"hidden\",\r\n    },\r\n    left: {\r\n        left: 0,\r\n    },\r\n    right: {\r\n        right: 0\r\n    },\r\n    swipeCanceled: {\r\n        transform: \"translateX(0) !important\",\r\n        transition: \"transform 0.5s\"\r\n    },\r\n    swipeRight: {\r\n        transform: \"translateX(100%) !important\",\r\n        transition: \"width 0.5s\"\r\n    },\r\n    swipeLeft: {\r\n        transform: \"translateX(-100%) !important\",\r\n        width: \"100% !important\",\r\n        transition: \"transform 0.5s, width 0.5s\"\r\n    },\r\n    grow: {\r\n        width: \"100% !important\",\r\n        transition: \"width 0.5s\"\r\n    },\r\n    shrink: {\r\n        width: \"0% !important\",\r\n        transition: \"width 0.5s\"\r\n    },\r\n});\r\n\r\ninterface Props extends WithStyles<typeof styles> {\r\n    swipeLeft?: {\r\n        action:() => void,\r\n        content: React.ReactNode\r\n    },\r\n    swipeRight?: {\r\n        action:() => void,\r\n        content: React.ReactNode \r\n    }\r\n}\r\n\r\nclass Swipable extends React.Component<Props, { cancelSwipe: boolean, swipedLeft: boolean, swipedRight: boolean, swipingLeft: boolean, swipingRight: boolean }> {\r\n    touchStartX: number = 0;\r\n    latestDeltaX: number = 0;\r\n    leftRef: React.RefObject<HTMLDivElement>;\r\n    rightRef: React.RefObject<HTMLDivElement>;\r\n    swipeRef: React.RefObject<HTMLDivElement>;\r\n    isSwipeLeft: boolean;\r\n    isSwipeRight: boolean;\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            cancelSwipe: false,\r\n            swipedLeft: false,\r\n            swipingLeft: false,\r\n            swipedRight: false,\r\n            swipingRight: false\r\n        }\r\n        this.leftRef = React.createRef();\r\n        this.rightRef = React.createRef();\r\n        this.swipeRef = React.createRef();\r\n        this.isSwipeLeft = this.props.swipeLeft ? true : false;\r\n        this.isSwipeRight = this.props.swipeRight ? true : false;\r\n\r\n    }\r\n\r\n\r\n    touchStart(event: TouchEvent) {\r\n        event.stopPropagation();\r\n        this.touchStartX = event.touches[0].clientX;\r\n        console.log(event.currentTarget)\r\n    }\r\n\r\n    touchMove(event: TouchEvent<HTMLElement>) {\r\n        event.stopPropagation();\r\n        if (!(this.isSwipeLeft || this.isSwipeRight)) {\r\n            return;\r\n        }\r\n        let deltaX = event.touches[0].clientX - this.touchStartX;\r\n        this.latestDeltaX = deltaX;\r\n        this.setState({ swipingRight: this.isSwipeRight && deltaX > 0, swipingLeft: this.isSwipeLeft && deltaX < 0 });\r\n        if (this.isSwipeRight && deltaX > 10 && this.leftRef.current) {\r\n            if (this.swipeRef.current) {\r\n                this.swipeRef.current.style.transform = `translateX(${deltaX}px)`;\r\n            }\r\n            this.leftRef.current.style.width = `${deltaX}px`;\r\n        }\r\n        if (this.isSwipeLeft && deltaX < -10 && this.rightRef.current) {\r\n            if (this.swipeRef.current) {\r\n                this.swipeRef.current.style.transform = `translateX(${deltaX}px)`;\r\n            }\r\n            this.rightRef.current.style.width = `${-deltaX}px`;\r\n        }\r\n    }\r\n\r\n    touchEnd(event: TouchEvent<HTMLElement>) {\r\n        event.stopPropagation();\r\n        let threshold = event.currentTarget.clientWidth * 0.5;\r\n        let style = this.swipeRef.current?.style;\r\n        if (this.isSwipeLeft && this.latestDeltaX < 0 && -this.latestDeltaX > threshold) {\r\n            this.setState({ swipedLeft: true }, this.props.swipeLeft?.action);\r\n        } else if (this.isSwipeRight && this.latestDeltaX > 0 && this.latestDeltaX > threshold) {\r\n            this.setState({ swipedRight: true }, this.props.swipeRight?.action);\r\n        } else {\r\n            this.setState({ cancelSwipe: true, swipingRight: false, swipingLeft: false });\r\n            setTimeout(() => {\r\n                if (style) {\r\n                    style.transform = `translateX(0px)`;\r\n                }\r\n                this.setState({ cancelSwipe: false });\r\n            }, 800);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n        return (\r\n            <div\r\n                className={classes.root}\r\n            >\r\n                {\r\n                    this.state.swipingRight || this.state.cancelSwipe ?\r\n                        <div\r\n                            className={clsx(\r\n                                classes.revealContent,\r\n                                classes.left, {\r\n                                [classes.grow]: this.state.swipedRight,\r\n                                [classes.shrink]: this.state.cancelSwipe\r\n                            })}\r\n                            ref={this.leftRef}\r\n                        >{this.props.swipeRight?.content}</div> :\r\n                        <></>\r\n                }\r\n                <div className={clsx({\r\n                    [classes.swipeCanceled]: this.state.cancelSwipe,\r\n                    [classes.swipeLeft]: this.state.swipedLeft,\r\n                    [classes.swipeRight]: this.state.swipedRight,\r\n                })}\r\n                    ref={this.swipeRef}\r\n                    onTouchStart={this.touchStart.bind(this)}\r\n                    onTouchMove={this.touchMove.bind(this)}\r\n                    onTouchEnd={this.touchEnd.bind(this)}>\r\n                    {this.props.children}\r\n                </div>\r\n                {\r\n                    this.state.swipingLeft || this.state.cancelSwipe ?\r\n                        <div\r\n                            className={clsx(\r\n                                classes.revealContent,\r\n                                classes.right, {\r\n                                [classes.grow]: this.state.swipedLeft,\r\n                                [classes.shrink]: this.state.cancelSwipe\r\n                            })}\r\n                            ref={this.rightRef}\r\n                        >{this.props.swipeLeft?.content}</div> :\r\n                        <></>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(Swipable);","import React, { MouseEvent } from 'react';\r\nimport { Avatar, withStyles, WithStyles, createStyles, makeStyles } from '@material-ui/core';\r\nimport translate from '../translations';\r\nimport { arrayToMap } from '../utils';\r\nimport gmailInstance, { IMessage, ILabel } from './gmailAPI';\r\nimport ContactMailIcon from '@material-ui/icons/ContactMail';\r\nimport ArchiveIcon from '@material-ui/icons/Archive';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport { CSSTransition } from \"react-transition-group\";\r\nimport Swipeable from '../components/Swipeable';\r\n\r\nexport function headerMap(headers: { name: string, value: any }[]) {\r\n    return arrayToMap(headers, header => header.name, header => header.value);\r\n}\r\n\r\n\r\nconst styles = createStyles({\r\n\r\n    root: {\r\n        display: 'flex',\r\n        position: 'relative',\r\n        \"&:hover $archive\": {\r\n            display: \"block\"\r\n        },\r\n        \"&-exit\": {\r\n            overflowX: \"hidden\",\r\n            transform: \"translateX(0)\",\r\n        },\r\n        \"&-exit-active\": {\r\n            transform: \"translateX(100%)\",\r\n            transition: \"transform 0.5s\"\r\n        }\r\n    },\r\n    header: {\r\n        overflowX: 'hidden'\r\n    },\r\n    archive: {\r\n        position: \"absolute\",\r\n        top: 10,\r\n        right: 10,\r\n        display: \"none\",\r\n        cursor: \"pointer\",\r\n        zIndex: 1\r\n    },\r\n    archiveSwipe: {\r\n        backgroundColor: \"green\",\r\n        height: \"100%\",\r\n        width: \"100%\"\r\n    },\r\n})\r\n\r\ninterface Props extends WithStyles<typeof styles> {\r\n    message: IMessage,\r\n    noOfMessages: number,\r\n    isThread?: boolean,\r\n    archiveMessage: (messageId: string) => void,\r\n}\r\n\r\ninterface State {\r\n    labels: ILabel[],\r\n    mounted: boolean\r\n}\r\n\r\n\r\nclass MessageHeader extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props)\r\n        this.state = {\r\n            labels: [],\r\n            mounted: true\r\n        }\r\n    }\r\n\r\n    archive(e: MouseEvent) {\r\n        e.stopPropagation()\r\n        this.setState({ mounted: false }, () => {\r\n            this.props.archiveMessage(this.props.message.id);\r\n        })\r\n    }\r\n\r\n    render() {\r\n        let { message, noOfMessages, isThread, classes } = this.props;\r\n        let headers = headerMap(message.payload.headers)\r\n        const subject = headers[\"Subject\"];\r\n        const from = headers[\"From\"].replace(\">\", \"\").split(\"<\");\r\n        from[0] = from[0].replace(/\"|\\\\/g, '');\r\n        const read = !message.labelIds.includes(\"UNREAD\");\r\n        const ref = React.createRef<HTMLDivElement>();\r\n        return (\r\n            <Swipeable swipeRight={{\r\n                action: () => this.props.archiveMessage(this.props.message.id),\r\n                content: <ArchiveIcon className={classes.archiveSwipe}></ArchiveIcon>\r\n            }}>\r\n                <CSSTransition\r\n                    in={this.state.mounted}\r\n                    unmountOnExit\r\n                    timeout={500}\r\n                    classNames={classes.root}\r\n                    nodeRef={ref}\r\n                >\r\n                    <div ref={ref} className={classes.root + \" message \" + (isThread ? \"threaded \" : \"\") + (read ? \"read\" : \"\")}>\r\n                        <Avatar>{from[0][0]}</Avatar>\r\n                        <div className={classes.header}>\r\n                            <div title={from[1]}><b>{from[0]}</b>{noOfMessages > 1 ? noOfMessages : \"\"}</div>\r\n                            <div><b>Subject:</b> {subject}</div>\r\n                            <div title={message.snippet} className=\"snippet\">{message.snippet}</div>\r\n                            <div style={{ display: \"flex\" }}>\r\n                                {this.state.labels.length === 0 ? <Tag id=\"placeHolder\" text={\"...\"}></Tag> : <></>}\r\n                                {this.state.labels.map((label: ILabel) => <Tag key={label.id} id={label.id} text={translate(label.name)} textColor={label.color?.textColor} backgroundColor={label.color?.backgroundColor}></Tag>)}\r\n                            </div>\r\n                        </div>\r\n                        <ArchiveIcon className={classes.archive} onClick={this.archive.bind(this)}></ArchiveIcon>\r\n                    </div>\r\n                </CSSTransition>\r\n            </Swipeable>\r\n        )\r\n    }\r\n\r\n    componentDidMount() {\r\n        gmailInstance.getLabels(this.props.message.labelIds.filter(id => !['UNREAD', 'INBOX'].includes(id)), this.props.message.id, false)\r\n            .then(labels => {\r\n                this.setState({ labels });\r\n            })\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(MessageHeader);\r\n\r\nexport function Tag(props: { textColor?: string, backgroundColor?: string, id: string, text: string }) {\r\n    const classes = makeStyles({\r\n        tagStyle: {\r\n            color: props.textColor || 'black',\r\n            background: props.backgroundColor || 'white',\r\n            borderRadius: '0.25em',\r\n            display: 'inline-block',\r\n            alignSelf: \"center\",\r\n            marginRight: '5px',\r\n            padding: '0 5px',\r\n        },\r\n        iconStyle:\r\n        {\r\n            marginRight: '5px',\r\n        },\r\n        important: {\r\n            color: \"gold\"\r\n        }\r\n    })();\r\n    switch (props.id) {\r\n        case 'CATEGORY_PERSONAL':\r\n            return <ContactMailIcon className={classes.iconStyle} ></ContactMailIcon>\r\n        case 'IMPORTANT':\r\n            return <StarIcon className={classes.iconStyle + \" \" + classes.important}></StarIcon>\r\n    }\r\n    return <div className={classes.tagStyle} >{props.text}</div>\r\n}","import React, { Component } from 'react';\r\nimport { headerMap } from './MessageHeader';\r\nimport CacheFirst from '../requestCache';\r\nimport logo from '../logo.svg';\r\nimport { keys } from '../constants';\r\n\r\nvar attachmentCache = new CacheFirst(keys.CACHE_ATTACHMENTS);\r\n\r\nfunction getBody(message: { parts: any; body: { data: string; }; }) {\r\n    var encodedBody = '';\r\n    if (typeof message.parts === 'undefined') {\r\n        encodedBody = message.body.data;\r\n    }\r\n    else {\r\n        encodedBody = getHTMLPart(message.parts);\r\n    }\r\n    encodedBody = convert(encodedBody);\r\n    return decodeURIComponent(escape(window.atob(encodedBody)));\r\n}\r\n\r\nfunction convert(encodedBody: string) {\r\n    return encodedBody.replace(/-/g, '+').replace(/_/g, '/').replace(/\\s/g, '');\r\n}\r\n\r\nfunction getHTMLPart(arr: any[]): string {\r\n    for (var x = 0; x <= arr.length; x++) {\r\n        if (typeof arr[x].parts === 'undefined') {\r\n            if (arr[x].mimeType === 'text/html') {\r\n                return arr[x].body.data;\r\n            }\r\n        }\r\n        else {\r\n            return getHTMLPart(arr[x].parts);\r\n        }\r\n    }\r\n    return '';\r\n}\r\n\r\nasync function getAttachment(attachment: Attachment) {\r\n    return await attachmentCache.get(attachment.cid, attachment.request).then(response => {\r\n        attachment.data = response.result.data;\r\n        return attachment;\r\n    })\r\n    // return new Promise(resolve =>{\r\n    //     attachmentCache.match(new Request(attachment.cid)).then(cachedResponse=>{\r\n    //         if (cachedResponse){\r\n    //             cachedResponse.json().then(json=>{\r\n    //                 attachment.data = json.data;    \r\n    //                 resolve(attachment)\r\n    //             })\r\n\r\n\r\n    //         }else {\r\n    //             attachment.request.execute(response=>{\r\n    //                 attachmentCache.put(new Request(attachment.cid), new Response(JSON.stringify(response)));\r\n    //                 attachment.data = response.data;\r\n    //                 resolve(attachment);\r\n    //             })\r\n    //         }\r\n    //     })\r\n    // })\r\n}\r\n\r\nfunction getAttachments(parts: any, messageId: string): { all: Attachment[], byCID: {[key: string]: Attachment} } {\r\n    let attachments = { all: [] as Attachment[], byCID: {} as {[key: string]: Attachment} };\r\n    if (!parts)\r\n        return attachments;\r\n    for (let part of parts) {\r\n        if (part.filename && part.filename.length > 0) {\r\n            var attachId = part.body.attachmentId;\r\n            var request = window.gapi.client.gmail.users.messages.attachments.get({\r\n                'id': attachId,\r\n                messageId,\r\n                'userId': 'me'\r\n            });\r\n            let headers = headerMap(part.headers)\r\n            let cid = headers['Content-ID']\r\n            if (cid)\r\n                cid = cid.replace('<', '').replace('>', '');\r\n            let attachment = new Attachment(attachId, part.filename, cid, part.mimeType, request);\r\n            attachments.all.push(attachment)\r\n            if (cid) {\r\n                attachments.byCID[cid] = attachment;\r\n            }\r\n        } else if (part.mimeType === 'multipart/related') {\r\n            let recAttachments = getAttachments(part.parts, messageId);\r\n            attachments.all.push(...recAttachments.all);\r\n            Object.assign(attachments.byCID, recAttachments.byCID);\r\n        }\r\n\r\n    }\r\n    return attachments;\r\n}\r\n\r\nclass Attachment {\r\n    id: string;\r\n    filename: string;\r\n    cid: string;\r\n    mimeType: string;\r\n    request: any;\r\n    data?: any;\r\n    constructor(id: string, filename: string, cid: string, mimeType: string, request: any) {\r\n        this.id = id;\r\n        this.filename = filename;\r\n        this.cid = cid;\r\n        this.mimeType = mimeType;\r\n        this.request = request;\r\n        this.data = null;\r\n    }\r\n\r\n    setData(data: any) {\r\n        this.data = data;\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n// function loadCID(messageId, cid, attachments) {\r\n\r\n\r\n//     return new Promise(resolve => {\r\n\r\n//         let fromStorage = ls.get(`${messageId}.${cid}`)\r\n//         if (fromStorage)\r\n//             resolve(fromStorage);\r\n//         else {\r\n//             let attachment = attachments.byCID[cid];\r\n//             if (attachment.loadingPromise) {\r\n//                 attachment.loadingPromise.then(resolve)\r\n//             } else {\r\n//                 attachment.loadingPromise = this;\r\n//                 attachment.request.execute(response => {\r\n//                     attachment.data = response.data;\r\n//                     let { request, loadingPromise, ...storeAttachtent } = attachment;\r\n//                     ls.set(`${messageId}.${cid}`, storeAttachtent);\r\n//                     resolve(attachment);\r\n//                 })\r\n//             }\r\n//         }\r\n//     });\r\n\r\n// }\r\n\r\nclass MessageBody extends Component<{message: any}, {body: string}> {\r\n    iframe: any;\r\n    timeOut?: number;\r\n\r\n    constructor(props: {message: any}) {\r\n        super(props)\r\n        this.state = {\r\n            body: getBody(props.message.payload)\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        let attachments = getAttachments(this.props.message.payload.parts, this.props.message.id);\r\n\r\n        let body = this.state.body;\r\n        // replace cids with placeholders\r\n        for (let cid of Object.keys(attachments.byCID)) {\r\n            body = body.split(`cid:${cid}`).join(`${logo}?${cid}`)\r\n        }\r\n        //inject mail.css\r\n        body = body.split('<head>').join('<head><link href=\"Mail.css\" rel=\"stylesheet\" type=\"text/css\">')\r\n        this.setState({body})\r\n\r\n        for (let attachment of Object.values(attachments.byCID)) {\r\n            getAttachment(attachment)\r\n                .then(loadedAttachment => {\r\n                    this.setState({ body: this.state.body.split(`${logo}?${loadedAttachment.cid}`).join(`data:${loadedAttachment.mimeType};base64,${convert(loadedAttachment.data)}`) })\r\n                })\r\n        }\r\n    }\r\n    componentDidUpdate() {\r\n        const iframe = this.iframe;\r\n        const document = iframe.contentDocument;\r\n        const html = document.getElementsByTagName('html')[0];\r\n        html.innerHTML = this.state.body;\r\n        this.timeOut = window.setTimeout(() => {\r\n            if (iframe.contentWindow) {\r\n                iframe.height = iframe.contentWindow.document.body.scrollHeight + 30;\r\n            }\r\n        }, 200)\r\n    }\r\n\r\n    componentDidUnMount() {\r\n        window.cancelTimeout(this.timeOut);\r\n    }\r\n\r\n    setIframeRef(iframe: any) {\r\n        this.iframe = iframe;\r\n    }\r\n\r\n    render() {\r\n        return <iframe title={this.props.message.snippet} ref={this.setIframeRef.bind(this)} width=\"100%\"></iframe>\r\n    }\r\n}\r\n\r\nexport default MessageBody;","import React from 'react';\r\nimport { Collapse } from '@material-ui/core';\r\nimport MessageHeader from './MessageHeader';\r\nimport MessageBody from './MessageBody';\r\nimport { IMessage } from './gmailAPI';\r\n\r\ninterface Props {\r\n    message: IMessage,\r\n    isThread?: boolean,\r\n    archiveMessage: (messageId: string) => void\r\n}\r\n\r\nexport default class Message extends React.Component<Props> {\r\n    state = {\r\n        open: false\r\n    }\r\n\r\n    toggleOpen() {\r\n        this.setState({ open: !this.state.open })\r\n    }\r\n\r\n    render() {\r\n        const { message, isThread, archiveMessage } = this.props;\r\n        return (\r\n            <>\r\n                <div onClick={this.toggleOpen.bind(this)}>\r\n                    <MessageHeader message={message} noOfMessages={1} isThread={isThread} archiveMessage={archiveMessage} />\r\n                </div>\r\n                <Collapse in={this.state.open} mountOnEnter unmountOnExit>\r\n                    <MessageBody message={message}></MessageBody>\r\n                </Collapse>\r\n            </>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport Collapsible from 'react-collapsible';\r\nimport MessageHeader from './MessageHeader';\r\nimport Message from './Message';\r\nimport CacheFirst from '../requestCache';\r\nimport { keys } from '../constants';\r\nimport gmailInstance, { IMessage, IThread } from './gmailAPI';\r\n\r\n\r\ninterface Props {\r\n    thread: IThread,\r\n    archiveThread: (id: string) => void;\r\n}\r\nclass GmailThread extends React.Component<Props, { messages: IMessage[] }> {\r\n    threadCache: CacheFirst;\r\n    constructor(props: Props) {\r\n        super(props)\r\n        this.state = {\r\n            messages: this.props.thread.messages || [],\r\n        }\r\n        this.threadCache = new CacheFirst(keys.CACHE_THREADS);\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.state.messages.length === 0) {\r\n            gmailInstance.getThread(this.props.thread.id)\r\n                .then(response => {\r\n                    const messages = response.result.messages;\r\n                    if (messages) {\r\n                        this.setState({\r\n                            messages\r\n                        })\r\n                    }\r\n                })\r\n        }\r\n    }\r\n\r\n    archiveMessage(messageId: string) {\r\n        gmailInstance.archiveMessage(messageId).then(_ => {\r\n            this.setState({ messages: this.state.messages.filter(message => message.id !== messageId) });\r\n        });\r\n    }\r\n\r\n    archiveThread() {\r\n        this.props.archiveThread(this.props.thread.id);\r\n    }\r\n\r\n    render() {\r\n        const noOfMessages = this.state.messages.length;\r\n        if (noOfMessages === 0) {\r\n            return <div>'loading...'</div>\r\n        } else {\r\n            const lastMessage = this.state.messages[noOfMessages - 1];\r\n            if (noOfMessages === 1) {\r\n                return (\r\n                    <Message message={lastMessage} archiveMessage={this.archiveThread.bind(this)} />\r\n                )\r\n            } else {\r\n                return (\r\n                    <Collapsible trigger={<MessageHeader message={lastMessage} noOfMessages={noOfMessages} archiveMessage={this.archiveThread.bind(this)} />}>\r\n                        {\r\n                            this.state.messages.map(message => {\r\n                                return (\r\n                                    <Message key={message.id} message={message} isThread={true} archiveMessage={this.archiveMessage.bind(this)} />\r\n                                )\r\n                            })\r\n                        }\r\n                    </Collapsible>\r\n                )\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default GmailThread;","import React from 'react'\r\nimport GmailThread from \"./Thread\";\r\nimport { IThread } from './gmailAPI';\r\n\r\nexport default function ThreadList(props: { threads: IThread[], archiveThread: (id: string) => void }) {\r\n    return (\r\n        <>\r\n            {props.threads\r\n                .map(thread => <GmailThread thread={thread} key={thread.id} archiveThread={props.archiveThread}></GmailThread>)}\r\n        </>\r\n    )\r\n}","import React, { MouseEvent, TouchEvent } from 'react';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport ExpandLess from '@material-ui/icons/ExpandLess';\r\nimport ExpandMore from '@material-ui/icons/ExpandMore';\r\nimport ArchiveIcon from '@material-ui/icons/Archive';\r\nimport translate from '../translations';\r\nimport ThreadList from './ThreadList';\r\nimport gmailInstance, { ILabel, IThread } from './gmailAPI';\r\nimport { withStyles, WithStyles, createStyles } from '@material-ui/core';\r\nimport { CSSTransition } from \"react-transition-group\";\r\nimport Swipeable from '../components/Swipeable';\r\n\r\nconst styles = createStyles({\r\n\r\n    root: {\r\n        \"@media (hover: hover)\": {\r\n            \"&:hover $archive\": {\r\n                display: \"inline-block\"\r\n            }\r\n        },\r\n        \"&-exit\": {\r\n            overflowX: \"hidden\",\r\n            transform: \"translateX(0)\",\r\n        },\r\n        \"&-exit-active\": {\r\n            transform: \"translateX(100%)\",\r\n            transition: \"transform 0.5s\"\r\n        },\r\n    },\r\n\r\n    archive: {\r\n        display: \"none\",\r\n        cursor: \"pointer\",\r\n        zIndex: 1\r\n    },\r\n    archiveSwipe: {\r\n        backgroundColor: \"green\",\r\n        height: \"100%\",\r\n        width: \"100%\"\r\n    }\r\n});\r\n\r\ninterface Props extends WithStyles<typeof styles> {\r\n    label?: ILabel,\r\n    category?: string,\r\n    onArchived?: (item: ILabel | string) => void;\r\n}\r\n\r\ninterface State {\r\n    name: string,\r\n    unread: number,\r\n    open: boolean,\r\n    threads: IThread[],\r\n    labelColors?: any,\r\n    mounted: boolean,\r\n}\r\n\r\nclass LabelGroup extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props)\r\n        let labelColors = {}\r\n        if (props.label?.color) {\r\n            labelColors = {\r\n                color: props.label.color.textColor,\r\n                backgroundColor: props.label.color.backgroundColor\r\n            }\r\n        }\r\n        let name = ''\r\n        if (props.category) {\r\n            name = translate(props.category);\r\n        } else if (props.label) {\r\n            name = translate(props.label.name);\r\n        }\r\n        this.state = {\r\n            name,\r\n            unread: 0,\r\n            open: false,\r\n            threads: [],\r\n            labelColors,\r\n            mounted: true,\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        let labelIds = ['INBOX'];\r\n        let query;\r\n        if (this.props.label) {\r\n            labelIds.push(this.props.label.id);\r\n        } else if (this.props.category) {\r\n            query = this.props.category;\r\n        }\r\n\r\n        gmailInstance.listThreads(this.state.name.replace(\":\", \"_\"), query, labelIds).then(result => {\r\n            let { threads, resultSizeEstimate } = result;\r\n            let unread = resultSizeEstimate;\r\n            if (this.props.label) {\r\n                unread = Math.min(this.props.label.messagesUnread, unread);\r\n            }\r\n            if (threads) {\r\n                this.setState({ threads, unread })\r\n            } else {\r\n                this.setState({ unread })\r\n            }\r\n        })\r\n    }\r\n\r\n    toggleOpen() {\r\n        this.setState({ open: !this.state.open });\r\n    }\r\n\r\n    archiveThread(id: string) {\r\n        gmailInstance.archiveThread(id).then(_ => {\r\n            this.setState({ threads: this.state.threads.filter(thread => thread.id !== id) })\r\n        })\r\n    }\r\n\r\n    archiveClicked(e: MouseEvent) {\r\n        e.stopPropagation();\r\n        this.archive(() => this.setState({ mounted: false }))\r\n    }\r\n\r\n    archive(then: () => void) {\r\n        gmailInstance.archiveThreads(this.state.threads.map(thread => thread.id)).then(_ => then());\r\n    }\r\n\r\n\r\n    onExited() {\r\n        if (this.props.onArchived) {\r\n            this.props.onArchived(this.props.label || this.props.category || \"\");\r\n        }\r\n    }\r\n\r\n\r\n    render() {\r\n        if (this.state.unread === 0) {\r\n            return ''\r\n        }\r\n        const { classes } = this.props;\r\n        const rootRef = React.createRef<HTMLDivElement>();\r\n\r\n        return (\r\n            <Swipeable swipeRight={{\r\n                action: () => this.archive(this.onExited.bind(this)),\r\n                content: <ArchiveIcon className={classes.archiveSwipe}></ArchiveIcon>\r\n            }}>\r\n                <CSSTransition\r\n                    in={this.state.mounted}\r\n                    unmountOnExit\r\n                    timeout={500}\r\n                    classNames={classes.root}\r\n                    onExited={this.onExited.bind(this)}\r\n                    nodeRef={rootRef}\r\n                >\r\n                    <div\r\n                        ref={rootRef}\r\n                        className={classes.root}\r\n                    >\r\n                        <ListItem style={this.state.labelColors} button onClick={this.toggleOpen.bind(this)}>\r\n                            <ListItemText primary={translate(this.state.name)} secondary={this.state.unread}></ListItemText>\r\n                            <ArchiveIcon className={classes.archive} onClick={this.archiveClicked.bind(this)}></ArchiveIcon>\r\n                            {this.state.open ? <ExpandLess /> : <ExpandMore />}\r\n                        </ListItem>\r\n                        <Collapse style={{ paddingLeft: \"1em\" }} in={this.state.open} timeout={\"auto\"} mountOnEnter>\r\n                            <ThreadList threads={this.state.threads} archiveThread={this.archiveThread.bind(this)}></ThreadList>\r\n                        </Collapse>\r\n                    </div>\r\n                </CSSTransition>\r\n            </Swipeable >\r\n        )\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(LabelGroup);","import React from 'react'\r\nimport { get as lsget } from 'local-storage'\r\nimport { systemFolders, keys, ISettings, defaultSettings, categories } from '../constants'\r\nimport CacheFirst, { NetworkFirst } from '../requestCache'\r\nimport ThreadList from './ThreadList'\r\nimport { List } from \"@material-ui/core\";\r\nimport { withStyles } from '@material-ui/core'\r\nimport LabelGroup from './LabelGroup'\r\nimport gmailInstance, { ILabel } from './gmailAPI';\r\nimport clsx from 'clsx';\r\n\r\ninterface Props {\r\n    classes: any\r\n}\r\n\r\nclass InboxView extends React.Component<Props, { settings: ISettings, threads: any[], labels: ILabel[], categories: string[] }> {\r\n    labelCache: CacheFirst\r\n    threadCache: NetworkFirst\r\n    constructor(props: Props) {\r\n        super(props)\r\n        this.state = {\r\n            settings: lsget(keys.settings) || defaultSettings,\r\n            threads: [],\r\n            labels: [],\r\n            categories\r\n        }\r\n        this.labelCache = new CacheFirst(keys.CACHE_LABELS);\r\n        this.threadCache = new NetworkFirst(keys.CACHE_THREADS);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getLabels();\r\n        this.getThreads();\r\n    }\r\n\r\n    getLabelFilter() {\r\n        let bundleLabels: ILabel[] = Object.values(this.state.settings.bundleLabels);\r\n        let filter = bundleLabels\r\n            .map(label => label.name)\r\n            .concat(systemFolders)\r\n            .map(label => `NOT label:${label}`)\r\n            .concat(this.state.categories.map(category => `NOT ${category}`)).join(\" \")\r\n        //  filter = categories.map(category=>`NOT ${category}`).join(\" \");\r\n        return filter;\r\n\r\n    }\r\n\r\n\r\n    getThreads() {\r\n        gmailInstance.listThreads(\"listThreads\", this.getLabelFilter()).then(result => {\r\n            let threads = result.threads || [];\r\n            this.setState({ threads });\r\n        });\r\n    }\r\n\r\n    getLabels() {\r\n        let labelIds: string[] = Object.values(this.state.settings.bundleLabels).map(label => label.id);\r\n        gmailInstance.getLabels(labelIds, \"bundleLabels\").then(labels => this.setState({ labels }));\r\n    }\r\n\r\n    archiveThread(id: string) {\r\n        gmailInstance.archiveThread(id).then(_ => {\r\n            this.setState({ threads: this.state.threads.filter(thread => thread.id !== id) })\r\n        })\r\n    }\r\n\r\n    categoryArchived(category: ILabel | string) {\r\n        this.setState({ categories: this.state.categories.filter(c => category !== c) })\r\n    }\r\n    labelArchived(label: ILabel | string) {\r\n        this.setState({ labels: this.state.labels.filter(l => l.id !== (label as ILabel).id) })\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n        return (\r\n            <List className={clsx(classes.root)}>\r\n                {this.state.categories.map(category => <LabelGroup key={category} category={category} onArchived={this.categoryArchived.bind(this)}></LabelGroup>)}\r\n                {this.state.labels.map(label => <LabelGroup key={label.id} label={label} onArchived={this.labelArchived.bind(this)}></LabelGroup>)}\r\n                <ThreadList threads={this.state.threads} archiveThread={this.archiveThread.bind(this)}></ThreadList>\r\n            </List>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default withStyles(theme => ({\r\n    root: {\r\n        flex: 1,\r\n        overflowY: 'auto',\r\n        overflowX: 'hidden',\r\n        backgroundColor: theme.palette.background.paper,\r\n    },\r\n}), { withTheme: true })(InboxView)","import React from 'react';\r\nimport logo from './logo.svg';\r\nimport './Gmail.css';\r\nimport BundleView from './gmail/BundleView';\r\nimport InboxView from './gmail/InboxView';\r\nimport { Button } from '@material-ui/core';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle'\r\n\r\nimport gmailInstance from './gmail/gmailAPI';\r\n\r\n\r\n\r\n\r\ndeclare global {\r\n    interface Window {\r\n        gapi: any;\r\n        cancelTimeout: any\r\n    }\r\n}\r\n\r\n\r\n\r\nclass GMail extends React.Component<{ onActivation: (title: string) => void }, { isSignedIn: boolean, messages: [], profileImage: string | any }> {\r\n    gapi: any;\r\n    constructor(props: Readonly<{ onActivation: (title: string) => void }>) {\r\n        super(props)\r\n        this.state = {\r\n            isSignedIn: false,\r\n            messages: [],\r\n            profileImage: null,\r\n        }\r\n        props.onActivation(\"Inbox\")\r\n\r\n    }\r\n    componentDidMount() {\r\n        gmailInstance.init();\r\n        gmailInstance.onSignInStatusChanged(this.updateSignInStatus.bind(this));\r\n    }\r\n\r\n    updateSignInStatus(isSignedIn: boolean) {\r\n        this.setState({ isSignedIn })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"gmail\">\r\n                {this.state.isSignedIn ?\r\n                    // <BundleView logo={logo} gmailApi={this.state.gmailApi}></BundleView> \r\n                    <InboxView /> :\r\n                    <>\r\n                        <h3>GManuail</h3>\r\n                        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n                        <Button variant=\"contained\" color=\"primary\" onClick={gmailInstance.authorize.bind(gmailInstance)}>\r\n                            <AccountCircle />\r\n                            &nbsp;&nbsp;Authorize with Gmail Account\r\n                        </Button>\r\n                    </>\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default GMail;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport List from '@material-ui/core/List';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Button from '@material-ui/core/Button';\r\nimport Divider from '@material-ui/core/Divider';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        margin: 'auto',\r\n        overflow: 'auto'\r\n    },\r\n    cardHeader: {\r\n        padding: theme.spacing(1, 2),\r\n    },\r\n    list: {\r\n        width: 300,\r\n        height: '60vh',\r\n        minHeight: 200,\r\n        backgroundColor: theme.palette.background.paper,\r\n        overflow: 'auto',\r\n    },\r\n    button: {\r\n        margin: theme.spacing(0.5, 0),\r\n    },\r\n}));\r\n\r\nfunction not(a: any[], b: any[]) {\r\n    return a.filter((value: any) => b.indexOf(value) === -1);\r\n}\r\n\r\nfunction intersection(a: any[], b: any[]) {\r\n    return a.filter((value: any) => b.indexOf(value) !== -1);\r\n}\r\n\r\nfunction union(a: any[], b: any[]) {\r\n    return [...a, ...not(b, a)];\r\n}\r\n\r\nexport default function TransferList(props: { labelProvider: any; selectionChanged: any; left: any[]; right: any[] }) {\r\n    const classes = useStyles();\r\n    const [checked, setChecked] = React.useState([] as any[]);\r\n    const [left, setLeft] = React.useState([] as any[]);\r\n    const [right, setRight] = React.useState([] as any[]);\r\n    const getLabel = props.labelProvider;\r\n    const rightUpdated = props.selectionChanged;\r\n\r\n    React.useEffect(() => {\r\n        setLeft(props.left)\r\n    }, [props.left]);\r\n\r\n    React.useEffect(() => {\r\n        setRight(props.right)\r\n    }, [props.right]);\r\n\r\n    const leftChecked = intersection(checked, left);\r\n    const rightChecked = intersection(checked, right);\r\n\r\n    const handleToggle = (value: any) => () => {\r\n        const currentIndex = checked.indexOf(value);\r\n        const newChecked = [...checked];\r\n\r\n        if (currentIndex === -1) {\r\n            newChecked.push(value);\r\n        } else {\r\n            newChecked.splice(currentIndex, 1);\r\n        }\r\n\r\n        setChecked(newChecked);\r\n    };\r\n\r\n    const numberOfChecked = (items: any[]) => intersection(checked, items).length;\r\n\r\n    const handleToggleAll = (items: any[]) => () => {\r\n        if (numberOfChecked(items) === items.length) {\r\n            setChecked(not(checked, items));\r\n        } else {\r\n            setChecked(union(checked, items));\r\n        }\r\n    };\r\n\r\n    const handleCheckedRight = () => {\r\n        const added = leftChecked;\r\n        setRight(right.concat(added));\r\n        setLeft(not(left, leftChecked));\r\n        setChecked(not(checked, leftChecked));\r\n        rightUpdated(added, [])\r\n    };\r\n\r\n    const handleCheckedLeft = () => {\r\n        const removed = rightChecked;\r\n        setLeft(left.concat(rightChecked));\r\n        setRight(not(right, rightChecked));\r\n        setChecked(not(checked, rightChecked));\r\n        rightUpdated([], removed);\r\n    };\r\n\r\n    const customList = (title: string, items: any[]) => (\r\n        <Card>\r\n            <CardHeader\r\n                className={classes.cardHeader}\r\n                avatar={\r\n                    <Checkbox\r\n                        onClick={handleToggleAll(items)}\r\n                        checked={numberOfChecked(items) === items.length && items.length !== 0}\r\n                        indeterminate={numberOfChecked(items) !== items.length && numberOfChecked(items) !== 0}\r\n                        disabled={items.length === 0}\r\n                        inputProps={{ 'aria-label': 'all items selected' }}\r\n                    />\r\n                }\r\n                title={title}\r\n                subheader={`${numberOfChecked(items)}/${items.length} selected`}\r\n            />\r\n            <Divider />\r\n            <List className={classes.list} dense component=\"div\" role=\"list\">\r\n                {items.map((value: any) => {\r\n                    const label = getLabel(value);\r\n                    const labelId = `transfer-list-all-item-${label}-label`;\r\n\r\n                    return (\r\n                        <ListItem key={label} role=\"listitem\" button onClick={handleToggle(value)}>\r\n                            <ListItemIcon>\r\n                                <Checkbox\r\n                                    checked={checked.indexOf(value) !== -1}\r\n                                    tabIndex={-1}\r\n                                    disableRipple\r\n                                    inputProps={{ 'aria-labelledby': labelId }}\r\n                                />\r\n                            </ListItemIcon>\r\n                            <ListItemText id={labelId} primary={`${label}`} />\r\n                        </ListItem>\r\n                    );\r\n                })}\r\n                <ListItem />\r\n            </List>\r\n        </Card>\r\n    );\r\n\r\n    return (\r\n        <Grid container spacing={2} justify=\"center\" alignItems=\"center\" className={classes.root}>\r\n            <Grid item>{customList('Choices', left)}</Grid>\r\n            <Grid item>\r\n                <Grid container direction=\"column\" alignItems=\"center\">\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        size=\"small\"\r\n                        className={classes.button}\r\n                        onClick={handleCheckedRight}\r\n                        disabled={leftChecked.length === 0}\r\n                        aria-label=\"move selected right\"\r\n                    >\r\n                        &gt;\r\n          </Button>\r\n                    <Button\r\n                        variant=\"outlined\"\r\n                        size=\"small\"\r\n                        className={classes.button}\r\n                        onClick={handleCheckedLeft}\r\n                        disabled={rightChecked.length === 0}\r\n                        aria-label=\"move selected left\"\r\n                    >\r\n                        &lt;\r\n          </Button>\r\n                </Grid>\r\n            </Grid>\r\n            <Grid item>{customList('Chosen', right)}</Grid>\r\n        </Grid>\r\n    );\r\n}","import React from 'react';\r\nimport { get as lsget, set as lsset } from 'local-storage';\r\nimport './Settings.css';\r\nimport TransferList from './components/TransferList';\r\nimport CacheFirst from './requestCache';\r\nimport translate from './translations';\r\nimport { noShow, defaultSettings, keys, categories } from './constants';\r\nimport { arrayToMap } from './utils';\r\nimport gmailInstance from './gmail/gmailAPI';\r\n\r\n\r\ninterface Props {\r\n    onActivation: (title: string) => void\r\n}\r\n\r\ninterface State {\r\n    labels: any,\r\n    bundleLabels: any,\r\n    sortLabel: any,\r\n}\r\n\r\nexport default class Settings extends React.Component<Props, State> {\r\n    cache: CacheFirst;\r\n\r\n    constructor(props: Readonly<Props>) {\r\n        super(props)\r\n        this.state = lsget(keys.settings) || defaultSettings;\r\n        this.cache = new CacheFirst(keys.CACHE_LABELS);\r\n        props.onActivation(\"Settings\");\r\n    }\r\n\r\n    componentDidMount() {\r\n        gmailInstance.onSignInStatusChanged(isSignedIn => {\r\n            if (isSignedIn) {\r\n                gmailInstance.listAllLabels().then(labels => {\r\n                    return labels.filter(label => !noShow.includes(label.id))\r\n                        .filter(label => !categories.includes(label.id.replace(\"_\", \":\").toLowerCase()))\r\n                        .sort((a, b) => translate(a.name) > translate(b.name) ? 1 : -1);\r\n                }).then(labels => {\r\n                    let labelMap = arrayToMap(labels, label => label.id, label => label);\r\n                    let unchosen: any = {}\r\n                    for (let key in labelMap) {\r\n                        if (!this.state.bundleLabels[key]) {\r\n                            unchosen[key] = labelMap[key];\r\n                        }\r\n                    }\r\n                    this.setState({ labels: unchosen });\r\n                });\r\n            }\r\n        })\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        lsset('settings', this.state);\r\n    }\r\n\r\n    selectionChanged(added: string | any[], removed: string | any[]) {\r\n        if (added.length === 0 && removed.length === 0)\r\n            return;\r\n\r\n        let labels = Object.assign({}, this.state.labels);\r\n        let bundleLabels = Object.assign({}, this.state.bundleLabels);\r\n\r\n        for (let add of added) {\r\n            bundleLabels[add.id] = add;\r\n            delete labels[add.id];\r\n        }\r\n\r\n        for (let remove of removed) {\r\n            delete bundleLabels[remove.id];\r\n            labels[remove.id] = remove;\r\n        }\r\n\r\n        this.setState({ labels, bundleLabels })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"settings\">\r\n                <h2>Settings</h2>\r\n                <TransferList left={Object.values(this.state.labels)} right={Object.values(this.state.bundleLabels)} labelProvider={(label: { name: string; }) => translate(label.name)} selectionChanged={this.selectionChanged.bind(this)}></TransferList>\r\n            </div>\r\n        )\r\n    }\r\n}","/**\r\n * Adapted from example code https://material-ui.com/components/drawers/#mini-variant-drawer\r\n */\r\n\r\nimport React, { useEffect } from 'react';\r\nimport clsx from 'clsx';\r\nimport { createStyles, makeStyles, useTheme, Theme } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      display: 'flex',\r\n    },\r\n    hide: {\r\n      display: 'none',\r\n    },\r\n    drawer: {\r\n      width: drawerWidth,\r\n      flexShrink: 0,\r\n      whiteSpace: 'nowrap',\r\n    },\r\n    drawerOpen: {\r\n      width: drawerWidth,\r\n      transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.enteringScreen,\r\n      }),\r\n    },\r\n    drawerClose: {\r\n      transition: theme.transitions.create('width', {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n      }),\r\n      overflowX: 'hidden',\r\n      width: 0,\r\n      [theme.breakpoints.up('sm')]: {\r\n        width: theme.spacing(9) + 1,\r\n      },\r\n    },\r\n    toolbar: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'flex-end',\r\n      padding: theme.spacing(0, 1),\r\n      // necessary for content to be below app bar\r\n      ...theme.mixins.toolbar,\r\n    },\r\n    content: {\r\n      flexGrow: 1,\r\n      padding: theme.spacing(3),\r\n    },\r\n  }),\r\n);\r\n\r\nexport default function MiniDrawer(props : any) {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  const { handleDrawerClose, ...otherProps} = props;\r\n  useEffect(()=>{\r\n    setOpen(props.open);\r\n  },[props.open])\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <CssBaseline />\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={handleDrawerClose}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List {...otherProps} >\r\n            \r\n        </List>\r\n      </Drawer>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport './App.css';\r\nimport GMail from './GMail'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport { createMuiTheme, ThemeProvider, makeStyles, Theme, createStyles } from '@material-ui/core/styles';\r\nimport {\r\n  HashRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link,\r\n} from \"react-router-dom\";\r\nimport Settings from './Settings';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport clsx from 'clsx';\r\nimport { IconButton, ListItem, ListItemIcon, ListItemText, Avatar } from '@material-ui/core';\r\nimport MiniDrawer from './components/MiniDrawer';\r\nimport MailIcon from '@material-ui/icons/Mail';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport gmailInstance from './gmail/gmailAPI';\r\nimport ExitToApp from '@material-ui/icons/ExitToApp';\r\n\r\n\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst useStyles = makeStyles((theme: Theme) => {\r\n  return createStyles({\r\n    root: {\r\n      display: 'flex',\r\n    },\r\n    appBar: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      transition: theme.transitions.create(['width', 'margin'], {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n      }),\r\n    },\r\n    content: {\r\n      marginTop: \"56px\",\r\n      height: \"calc(100vh - 56px)\",\r\n      [theme.breakpoints.up(\"xs\") + \"and (orientation: landscape)\"]: {\r\n        marginTop: \"48px\",\r\n        height: \"calc(100vh - 48px)\",\r\n      },\r\n      width: `100vw`,\r\n      marginLeft: 0,\r\n      [theme.breakpoints.up('sm')]: {\r\n        width: `calc(100vw - ${theme.spacing(10)}px)`,\r\n        marginLeft: theme.spacing(10),\r\n        marginTop: \"64px\",\r\n        height: \"calc(100vh - 64px)\",\r\n      },\r\n      // flexGrow: \"1\",\r\n      backgroundColor: \"#111\",\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n      color: \"white\",\r\n      transition: theme.transitions.create(['width', 'margin'], {\r\n        easing: theme.transitions.easing.sharp,\r\n        duration: theme.transitions.duration.leavingScreen,\r\n      }),\r\n    },\r\n    shroud: {\r\n      display: 'none',\r\n      [theme.breakpoints.down('xs')]: {\r\n        display: 'block',\r\n        position: 'absolute',\r\n        left: 0,\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        backgroundColor: 'rgba(0,0,0,0.7)',\r\n        cursor: 'pointer',\r\n        zIndex: 1\r\n      }\r\n    },\r\n    appBarShift: {\r\n      [theme.breakpoints.up('sm')]: {\r\n        marginLeft: drawerWidth,\r\n        width: `calc(100vw - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n          easing: theme.transitions.easing.sharp,\r\n          duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n      }\r\n    },\r\n    menuButton: {\r\n      marginRight: 36,\r\n    },\r\n    hide: {\r\n      [theme.breakpoints.up('sm')]: {\r\n        display: 'none',\r\n      }\r\n    },\r\n    toolbar: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      //justifyContent: 'flex-end',\r\n      padding: theme.spacing(0, 1),\r\n      // necessary for content to be below app bar\r\n      ...theme.mixins.toolbar,\r\n    },\r\n    buttons: {\r\n      marginLeft: \"auto\"\r\n    }\r\n  })\r\n});\r\n\r\nfunction App() {\r\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [isSignedIn, setSignedIn] = React.useState(false);\r\n  const [profileImage, setProfileImage] = React.useState('');\r\n  const [title, setTitle] = React.useState('')\r\n  React.useEffect(() => {\r\n    gmailInstance.onSignInStatusChanged(isSignedIn => {\r\n      setSignedIn(isSignedIn);\r\n      if (isSignedIn) {\r\n        if (isSignedIn) {\r\n          var profile = gmailInstance.getCurrentUserProfile();\r\n          setProfileImage(profile.getImageUrl());\r\n        }\r\n      }\r\n    })\r\n  }, [])\r\n  const handleDrawerOpen = () => {\r\n    setOpen(!open);\r\n  };\r\n\r\n  const handleDrawerClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const theme = React.useMemo(\r\n    () =>\r\n      createMuiTheme({\r\n        palette: {\r\n          type: prefersDarkMode ? 'dark' : 'light',\r\n        },\r\n      }),\r\n    [prefersDarkMode],\r\n  );\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar className={clsx(classes.toolbar)}>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={handleDrawerOpen}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap>\r\n            {title}\r\n          </Typography>\r\n          <div className={classes.buttons}>\r\n            {!isSignedIn ?\r\n              '' :\r\n              <div style={{ display: 'inline-flex' }}>\r\n                <Avatar src={profileImage}></Avatar>\r\n                <IconButton onClick={gmailInstance.signOut.bind(gmailInstance)}>\r\n                  <ExitToApp />\r\n                </IconButton>\r\n              </div>\r\n            }\r\n          </div>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Router>\r\n        <div className={clsx({ [classes.shroud]: open })} onClick={handleDrawerClose} />\r\n        <MiniDrawer open={open} handleDrawerClose={handleDrawerClose}>\r\n          <Link className=\"nostyle\" to=\"/\">\r\n            <ListItem>\r\n              <ListItemIcon>\r\n                <MailIcon />\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                Inbox\r\n            </ListItemText>\r\n            </ListItem>\r\n          </Link>\r\n          <Link className=\"nostyle\" to=\"/settings\">\r\n            <ListItem>\r\n              <ListItemIcon>\r\n                <SettingsIcon />\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                Settings\r\n            </ListItemText>\r\n            </ListItem>\r\n          </Link>\r\n        </MiniDrawer>\r\n        <div className={clsx(classes.content, {\r\n          [classes.appBarShift]: open,\r\n        }) + \" App\"}>\r\n          <Switch>\r\n            <Route path=\"/settings\">\r\n              <Settings onActivation={setTitle}></Settings>\r\n            </Route>\r\n            <Route path=\"/\">\r\n              <GMail onActivation={setTitle}></GMail>\r\n            </Route>\r\n          </Switch>\r\n        </div>\r\n      </Router>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.register();","module.exports = __webpack_public_path__ + \"static/media/logo.ee7cd8ed.svg\";"],"sourceRoot":""}